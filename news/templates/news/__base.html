{% load static %}{% load humanize %}{% load emaildigest_extra %}<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="{{SITE_NAME}}">
    <meta property="og:site_name" content="{{SITE_NAME}}">
    <meta name="theme-color" content="#306998" />
    <meta name="robots" content="noindex,nofollow" />
    <meta name="googlebot" content="noindex,nofollow" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="renderer" content="webkit|ie-comp|ie-stand" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="{% static 'news.css'%}" />
    <link rel="icon" type="image/png" sizes="32x32" href="{% static 'icon.png' %}" />
    <title>{% block title %}{% endblock title %}{{SITE_NAME}}</title>

    <script>
        /*
                         _                                         _
                        (_)                                       | |
             _ __ ___    _  __  __  _ __     __ _   _ __     ___  | |
            | '_ ` _ \  | | \ \/ / | '_ \   / _` | | '_ \   / _ \ | |
            | | | | | | | |  >  <  | |_) | | (_| | | | | | |  __/ | |
            |_| |_| |_| |_| /_/\_\ | .__/   \__,_| |_| |_|  \___| |_|
                                   | |
                                   |_|
        */

        // Tell Mixpanel to load the library from our self-hosted proxy (see urls.py)
        const MIXPANEL_CUSTOM_LIB_URL = "/lib.min.js";

        // Load the Mixpanel JS SDK asyncronously using the snippet provided by Mixpanel. Note: Alternatively, you can use the NPM module version (https://www.npmjs.com/package/mixpanel-browser)
        (function(f,b){if(!b.__SV){var e,g,i,h;window.mixpanel=b;b._i=[];b.init=function(e,f,c){function g(a,d){var b=d.split(".");2==b.length&&(a=a[b[0]],d=b[1]);a[d]=function(){a.push([d].concat(Array.prototype.slice.call(arguments,0)))}}var a=b;"undefined"!==typeof c?a=b[c]=[]:c="mixpanel";a.people=a.people||[];a.toString=function(a){var d="mixpanel";"mixpanel"!==c&&(d+="."+c);a||(d+=" (stub)");return d};a.people.toString=function(){return a.toString(1)+".people (stub)"};i="disable time_event track track_pageview track_links track_forms track_with_groups add_group set_group remove_group register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking start_batch_senders people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user people.remove".split(" ");
        for(h=0;h<i.length;h++)g(a,i[h]);var j="set set_once union unset remove delete".split(" ");a.get_group=function(){function b(c){d[c]=function(){call2_args=arguments;call2=[c].concat(Array.prototype.slice.call(call2_args,0));a.push([e,call2])}}for(var d={},e=["get_group"].concat(Array.prototype.slice.call(arguments,0)),c=0;c<j.length;c++)b(j[c]);return d};b._i.push([e,f,c])};b.__SV=1.2;e=f.createElement("script");e.type="text/javascript";e.async=!0;e.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?
        MIXPANEL_CUSTOM_LIB_URL:"file:"===f.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";g=f.getElementsByTagName("script")[0];g.parentNode.insertBefore(e,g)}})(document,window.mixpanel||[]);

        const cookies = document.cookie.split('; ').reduce((acc, entry) => {const [k, v] = entry.split('='); acc[k] = v; return acc}, {});

        // Initialize an instance using the project token specified in settings.py
        mixpanel.init("{{MIXPANEL_PROJECT_TOKEN}}", {
            // Enable debug mode to turn on console logging
            debug: true,

            // Use the django proxy endpoint for mixpanel api calls (see news/urls.py)
            // This allows you to send data through your own servers instead of directly to Mixpanel from the client
            // This can be benificial to avoid calls from being erroneously blocked by ad blockers
            api_host: "/proxy",

            // Turn off persisence. This means nothing will be stored in the browser (cookies or local storage).
            // This is one way of conforming with ePrivacy laws that doesn't require an opt-in banner.
            disable_persistence: true,
        })

        // now we can track any events we want on the client-side using `mixpanel.track(...)`
        mixpanel.track("Page loaded [client-side]", {

            // use the session cookie generated by our server as the distinct_id of the user
            // when a user logs in, we'll associate this id with their username (see hnclone/middleware.py and accounts/receivers.py)
            "distinct_id": cookies["sess"],

        });
    </script>
</head>


<body>
    <main id="pnmain">
        <nav id="top-bar">
            <table border="0" cellpadding="0" cellspacing="0" width="100%" style="padding:2px">
                <tbody>
                    <tr>
                        <td style="width:18px;padding-right:4px"><a href={% url 'index' %}><svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="28" height="28" rx="4" fill="#4F44E0"></rect><circle cx="8" cy="14" r="3" fill="white"></circle><circle cx="16" cy="14" r="2" fill="white"></circle><circle cx="22" cy="14" r="1" fill="white"></circle></svg></td>
                        <td style="line-height:12pt; height:10px;">
                            <span class="pagetop">
                            <b class="pnname">

                            <a href="{% url 'index' %}">{{SITE_NAME}}</a></b>
                            {% url 'newest' as url %}
                            <a href="{{ url }}" {% if url == request.path %}class="active"{% endif %}>new</a>
                            | {% url 'threads' as url %}
                            <a href="{{ url }}" {% if url == request.path %}class="active"{% endif %}>threads</a>
                            | {% url 'comments' as url %}
                            <a href="{{ url }}" {% if url == request.path %}class="active"{% endif %}>comments</a>
                            | {% url 'ask' as url %}
                            <a href="{{ url }}" {% if url == request.path %}class="active"{% endif %}>ask</a>
                            | {% url 'show' as url %}
                            <a href="{{ url }}" {% if url == request.path %}class="active"{% endif %}>show</a>
                            {% url 'submit' as url %}
                            | <a href="{{ url }}" {% if url == request.path %}class="active"{% endif %}>submit</a>
                            </span></td>
                        <td style="text-align:right;padding-right:4px;">
                        <span class="pagetop">
                            {% if user.is_authenticated %}
                            {% url 'accounts_my_profile' as url %}
                            <a href="{{ url }}" {% if url == request.path %}class="active"{% endif %}>{{user}}</a> ({{user.karma}})
                            | <form method="POST" action="{% url 'logout' %}" class="logout-form">{% csrf_token %}&nbsp;<button class="logout-button">logout</button></form>
                            {% else %}
                            {% url 'login' as url %}
                            <a href="{{ url }}" {% if url == request.path %}class="active"{% endif %}>login</a>
                            {% url 'accounts_register' as url %}
                            | <a href="{{ url }}" {% if url == request.path %}class="active"{% endif %}>register</a>
                            {% endif %}
                        </span></td>
                    </tr>
                </tbody>
            </table>
        </nav>

{% block content %}{% endblock content %}

        <nav id="pre-footer-bar">
            <hr>
            {% if not prevent_footer_subscription_form %}
                {% digest_subscription_form user=user %}
            {% endif %}
        </nav>


        <nav id="footer-bar">
            <a href="https://mixpanel.com/report/{{MIXPANEL_PROJECT_ID}}" target="_blank" onclick="mixpanel.track('Opened Mixpanel', {source: 'footer'})">View this data in Mixpanel</a> | Mixpanel user: {{MIXPANEL_ADMIN_USERNAME}} | password: {{MIXPANEL_ADMIN_PASSWORD}}
        </nav>
    </main>
<script type="text/javascript" src="{% static 'news.js'%}"></script>
</body>
</html>
